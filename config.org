* Environment
** Settings
#+BEGIN_SRC emacs-lisp
    ;; Splash Screen
    (setq inhibit-splash-screen t
	initial-scratch-message nil
	initial-major-mode 'org-mode)

    (setq x-select-enable-clipboard t)
    (desktop-save-mode 1) ;; automatically save/restore sessions

    (setq make-backup-files nil) ;; disable backup files
    ;; (setq auto-save-default nil) ;; disable auto-save files

    (defalias 'yes-or-no-p 'y-or-n-p) ;; Yes and No prompt

    ;; Misc
    (setq echo-keystrokes 0.1 ;; Turn down the time to echo keystrokes
	    use-dialog-box nil ;; use the echo area instead of dialog boxes
	    visible-bell t) ;; Use a visual indicator instead of making horrible noises

    ;; Vendor directory (for manually installed packages)
    (defvar sads/vendor-dir (expand-file-name "vendor" user-emacs-directory))
    (add-to-list 'load-path sads/vendor-dir)

    (dolist (project (directory-files sads/vendor-dir t "\\w+"))
    (when (file-directory-p project)
	(add-to-list 'load-path project)))
#+END_SRC

** Keybindings
#+BEGIN_SRC emacs-lisp
  ;; (global-set-key (kbd "RET") 'newline-and-indent)
  (global-set-key (kbd "C-;") 'comment-or-uncomment-region)
  (global-set-key (kbd "C-<tab>") 'dabbrev-expand)
  (define-key minibuffer-local-map (kbd "C-<tab>") 'dabbrev-expand)
  ;; paste from clipboard by middle mouse button
  (global-set-key (kbd "<mouse-2>") 'clipboard-yank)
#+END_SRC

** Navigation
ido + smex | helm | swiper -- 3 different ways
#+BEGIN_SRC emacs-lisp
  (setq ibuffer-expert t)
#+END_SRC
*** Buffers
#+BEGIN_SRC emacs-lisp
  (evil-leader/set-key "w" 'save-buffer)
  (evil-leader/set-key "bd" 'kill-buffer)
  (evil-leader/set-key "bm" 'ibuffer)
  (evil-leader/set-key "bo" 'switch-to-buffer)
  (global-set-key (kbd "C-c p") 'mode-line-other-buffer)
#+END_SRC

*** Window configurations
#+BEGIN_SRC emacs-lisp
  (evil-leader/set-key "cs" 'window-configuration-to-register)
  (evil-leader/set-key "cr" 'jump-to-register)
#+END_SRC

** Not used / unknown purpose
   #+BEGIN_SRC emacs-lisp
     ;; (setenv "PATH" (concat "/usr/local/bin:/opt/local/bin:/usr/bin:/bin" (getenv "PATH")))
     ;; (setq exec-path (append exec-path '("/usr/local/bin")))
     (require 'cl)

     ;; Terminal setup (stop prompt appearing each time when starting 'ansi-term')
     ;; (defvar my-term-shell "/bin/bash")
     ;; (defadvice ansi-term (before force-bash)
     ;;   (interactive (list my-term-shell)))
     ;; (ad-activate 'ansi-term)


     ;; (setq backup-directory-alist `((".*" . ,temporary-file-directory)))
     ;; (setq auto-save-file-name-transforms `((".*" ,temporary-file-directory t)))

     ;; shell-script-mode
     (add-to-list 'auto-mode-alist '("\\.zsh$" . shell-script-mode))

     ;; conf-mode
     (add-to-list 'auto-mode-alist '("\\.gitconfig$" . conf-mode))
   #+END_SRC


* Appearance
** Packages
*** Spacemacs-theme
#+BEGIN_SRC emacs-lisp
  (use-package spacemacs-common
      :ensure spacemacs-theme
      :config (load-theme 'spacemacs-dark t))
#+END_SRC

*** Rainbow
#+BEGIN_SRC emacs-lisp
  (use-package rainbow-mode
    :defer t
    :init (rainbow-mode 1))
#+END_SRC
** Other visual settings
#+BEGIN_SRC emacs-lisp
  ;; Change cursor color depending on mode (only GUI emacs)
  (setq evil-emacs-state-cursor '("cyan" box))
  (setq evil-normal-state-cursor '("cyan" box))
  (setq evil-visual-state-cursor '("orange" box))
  (setq evil-insert-state-cursor '("green" bar))
  (setq evil-replace-state-cursor '("red" bar))
  (setq evil-operator-state-cursor '("cyan" hollow))

  ;; marking text
  (delete-selection-mode t)
  (transient-mark-mode t)

  ;; font perks
  (global-prettify-symbols-mode t) ;; type 'lambda' to understand

  ;; Scroll-, tool-, menu bars*
  (tool-bar-mode -1)
  (menu-bar-mode -1)
  (if window-system (toggle-scroll-bar -1))

  ;; show line numbers
  (when (version<= "26.0.50" emacs-version )
  (global-display-line-numbers-mode))

  ;; Display Settings
  (setq-default indicate-empty-lines t)
  (when (not indicate-empty-lines)
  (toggle-indicate-empty-lines))

  (setq-default show-trailing-whitespace t)

  (show-paren-mode t) ;; highlight parentheses
#+END_SRC
** Not used / known
   #+BEGIN_SRC emacs-lisp
     ;; Indentation
     ;; (setq tab-width 2
     ;;       indent-tabs-mode nil)

     ;; when in GUI - highlight the line with the cursor
     ;; didn't enable cuz of the comment line highlighting in emacs theme
     ;; (when window-system (global-hl-line-mode t))

     ;; highlight the line with the cursor
     ;; (when window-system (global-hl-line-mode t))

     ;; Color Codes
     (require 'ansi-color)
     (defun colorize-compilation-buffer ()
       (toggle-read-only)
       (ansi-color-apply-on-region (point-min) (point-max))
       (toggle-read-only))
     (add-hook 'compilation-filter-hook 'colorize-compilation-buffer)
   #+END_SRC


* Default packages
#+BEGIN_SRC emacs-lisp
  (setq dired-dwim-target t)
#+END_SRC

* Packages update
*slows down the startup A LOT*
#+BEGIN_SRC emacs-lisp
  ;; (use-package auto-package-update
  ;;   :config
  ;;   (setq auto-package-update-delete-old-versions t)
  ;;   (setq auto-package-update-hide-results t)
  ;;   (auto-package-update-maybe))
#+END_SRC
* ORG
  *do that with 'use-package'
** main settings
#+BEGIN_SRC emacs-lisp
  (use-package org

    :init
    ;; kbd
    (evil-leader/set-key "oc" 'org-capture)
    (evil-leader/set-key "oa" 'org-agenda)
    ;; enable flyspell-mode and writegood-mode
    (add-hook 'org-mode-hook (lambda () (flyspell-mode)))
    (add-hook 'org-mode-hook (lambda () (writegood-mode)))
    (add-hook 'org-mode-hook (lambda () (abbrev-mode 1)))

    :config
    ;; set maximum indentation for description lists
    (setq org-list-description-max-indent 5)
    ;; prevent demoting heading also shifting text inside sections
    (setq org-adapt-indentation nil)
    ;; enable logging when tasks are complete
    (setq org-log-done t
	  org-todo-keywords '((sequence "TODO" "INPROGRESS" "DONE"))
	  org-todo-keyword-faces '(("INPROGRESS" . (:foreground "blue" :weight bold))))

    ;; handling errors
    :catch (lambda (keyword err)
	     (message (error-message-string err))))

  ;; there is also *org-agenda* and *org-habit* setup in this tut, but i skipped it for now
#+END_SRC
** visual settings
#+BEGIN_SRC emacs-lisp
  ;; bullets instead of asteric
  (use-package org-bullets
    :config
    (add-hook 'org-mode-hook (lambda () (org-bullets-mode))))

  (setq org-src-fontify-natively t) ;;syntax highlight code blocks
#+END_SRC
** org-babel
#+BEGIN_SRC emacs-lisp
  ;; (require 'ob) ;; don't know what for is this line

  ;; embedd languages inside .org files with proper font-locking
  ;; Allows to extract and execute code.
  (org-babel-do-load-languages
   'org-babel-load-languages
   '((shell . t)
     (js . t)
     (C . t)))

  ;; (setq org-confirm-babel-evaluate nil)
  ;;
  ;; (add-hook 'org-babel-after-execute-hook (lambda ()
  ;;                                           (condition-case nil
  ;;                                               (org-display-inline-images)
  ;;                                             (error nil)))
  ;;           'append)

#+END_SRC

** agenda/todo setup
#+BEGIN_SRC emacs-lisp
  (setq org-agenda-files (quote ("~/Desktop/todo.org"))) ;; dunno if it's gonna work

  ;; keybindings
  (evil-leader/set-key "oc" 'org-capture)
  (evil-leader/set-key "oa" 'org-agenda)

  ;;set priority range from A to C with default A
  (setq org-highest-priority ?A)
  (setq org-lowest-priority ?C)
  (setq org-default-priority ?A)

  ;;set colours for priorities
  (setq org-priority-faces '((?A . (:foreground "#F0DFAF" :weight bold))
			     (?B . (:foreground "LightSteelBlue"))
			     (?C . (:foreground "OliveDrab"))))

  ;;open agenda in current window
  (setq org-agenda-window-setup (quote current-window))

  (setq org-capture-templates
	'(("t" "todo" entry (file+headline "~/Desktop/todo.org" "Tasks")
	   "* TODO [#A] %?\nSCHEDULED: %(org-insert-time-stamp (org-read-date nil t \"+0d\"))\n")))

  ;; org-mode agenda options

  (setq org-deadline-warning-days 7) ;; warn of any deadlines in next 7 days
  (setq org-agenda-span (quote fortnight)) ;;show tasks scheduled in next fortnight
  (setq org-agenda-skip-scheduled-if-deadline-is-shown t)
  (setq org-agenda-skip-deadline-prewarning-if-scheduled (quote pre-scheduled))
  ;;don't show tasks that are scheduled or have deadlines in the normal todo list
  (setq org-agenda-todo-ignore-deadlines (quote all))
  (setq org-agenda-todo-ignore-scheduled (quote all))

  ;;sort tasks in order of when they are due and then by priority
  (setq org-agenda-sorting-strategy
    (quote
     ((agenda deadline-up priority-down)
      (todo priority-down category-keep)
      (tags priority-down category-keep)
      (search category-keep))))
#+END_SRC

* Magit
#+BEGIN_SRC emacs-lisp
  (use-package magit
    :init
    (evil-leader/set-key "gi" 'magit-init)
    (evil-leader/set-key "gs" 'magit-status))
#+END_SRC
* Evil
** evil itself
#+BEGIN_SRC emacs-lisp
  (use-package evil
    :init (evil-mode t)
    :bind ("M-c" . evil-normal-state)
    :config
    ;; brings cursor at the middle of the screen after pressing 'n' in evil-mode
    (defadvice evil-ex-search-next (after advice-for-evil-ex-search-next activate)
      (evil-scroll-line-to-center (line-number-at-pos))))
#+END_SRC
** evil-leader
#+BEGIN_SRC emacs-lisp
  (use-package evil-leader
    :init
    (setq evil-leader/in-all-states 1)
    (global-evil-leader-mode)
    (evil-leader/set-leader ","))
#+END_SRC

* IDO
  is it possible to make ido search for regexp?
** IDO enable
#+BEGIN_SRC emacs-lisp
  (setq ido-enable-flex-matching nil)
  (setq ido-create-new-buffer 'always)
  (setq ido-everywhere t)
  (ido-mode 1)
#+END_SRC
** IDO-vertical
#+BEGIN_SRC emacs-lisp
  (use-package ido-vertical-mode
    :init
    (ido-vertical-mode 1))
    (setq ido-vertical-define-keys 'C-n-and-C-p-only) ;; move between options
#+END_SRC
** Smex
*Package to get completion in ~M-x~ menu (and most used commands will be at top)*
#+BEGIN_SRC emacs-lisp
  (use-package smex
    :init (smex-initialize)

    :bind
    ("M-x" . smex)
    ("M-X" . smex-major-mode-commands))

  ;; don't know for what is setting below
  ;; (setq smex-save-file (expand-file-name ".smex-items" user-emacs-directory))
#+END_SRC

* Evil-mc (multiple cursors) | [[https://github.com/gabesoft/evil-mc][github]]
#+BEGIN_SRC emacs-lisp
  (use-package evil-mc
    :init
    (global-evil-mc-mode 1)
    (evil-define-key 'visual evil-mc-key-map
      "A" #'evil-mc-make-cursor-in-visual-selection-end
      "I" #'evil-mc-make-cursor-in-visual-selection-beg))

  (evil-leader/set-key "ma" 'evil-mc-make-all-cursors)
  (evil-leader/set-key "mu" 'evil-mc-undo-all-cursors)
  (evil-leader/set-key "mn" 'evil-mc-make-and-goto-next-match)
  (evil-leader/set-key "mp" 'evil-mc-make-and-goto-prev-match)
  (evil-leader/set-key "mf" 'evil-mc-skip-and-goto-next-match)
  (evil-leader/set-key "mb" 'evil-mc-skip-and-goto-prev-match)
  (evil-leader/set-key "mz" 'evil-mc-undo-last-added-cursor)
#+END_SRC

* Projectile
#+BEGIN_SRC emacs-lisp
  (use-package projectile
    :init
    (projectile-mode +1)
    (evil-leader/set-key "pf" 'projectile-find-file))
#+END_SRC


* Markdown-mode
#+BEGIN_SRC emacs-lisp
  (use-package markdown-mode
    :ensure t
    :mode (("README\\.md\\'" . gfm-mode)
	   ("\\.md\\'" . markdown-mode)
	   ("\\.markdown\\'" . markdown-mode))
    :init (setq markdown-command "multimarkdown"))
#+END_SRC
* Powerline
#+BEGIN_SRC emacs-lisp
  (use-package powerline
    :init (powerline-default-theme))
#+END_SRC


* User functions
** Config edit/reload
#+BEGIN_SRC emacs-lisp
  ;; edit
  (defun config-visit()
    (interactive)
    (find-file "~/git/emacs_init/config.org"))
  (global-set-key (kbd "C-c e") 'config-visit)

  ;; reload
  (defun config-reload()
    (interactive)
    (org-babel-load-file (get-fullpath "config.org")))
  (global-set-key (kbd "C-c r") 'config-reload)
#+END_SRC
** Identation & buffer cleanups
#+BEGIN_SRC emacs-lisp
  ;; This re-indents, untabifies, and cleans up whitespace
  (defun untabify-buffer ()
    (interactive)
    (untabify (point-min) (point-max)))

  (defun indent-buffer ()
    (interactive)
    (indent-region (point-min) (point-max)))

  "Perform a bunch of operations on the whitespace content of a buffer."
  (defun cleanup-buffer ()
    (interactive)
    (indent-buffer)
    (untabify-buffer)
    (delete-trailing-whitespace))
  ;; (global-set-key (kbd "C-c n") 'cleanup-buffer)

  "Remove tmux artifacts from region."
  (defun cleanup-region (beg end)
    (interactive "r")
    (dolist (re '("\\\\│\·*\n" "\W*│\·*"))
      (replace-regexp re "" nil beg end)))
  (global-set-key (kbd "C-x M-t") 'cleanup-region)
#+END_SRC



* Keybindings
** Packages
*** Helm
#+BEGIN_SRC emacs-lisp
  ;; (evil-leader/set-key "x" 'helm-M-x)
  ;; (global-set-key (kbd "M-x") 'helm-M-x)
  ;; (global-set-key (kbd "C-h o") 'helm-occur)
  ;; (evil-leader/set-key "hf" 'helm-find-files)
  ;; (evil-leader/set-key "hb" 'helm-buffers-list)
  ;; (evil-leader/set-key "hp" 'helm-browse-project)
#+END_SRC
